# Описание

Файлы `DirectionFinder`, `GlobalVar`, `Trajectory`, `DiffPhase`, `MoveSource`, `RunDirectionFinder`
относятся к модели фазового пеленгатора. <br>
Файлы `DigitalPhaseMeter`, `GlobalVarPhaseMeter`, `ChangePhase`, `RunDigitalPhaseMeter`
относятся к модели цифрового фазометра, которая использовалась для расчёта погрешности
измерения разности фаз. <br>
Файл `PostProcessing` предназначен для сравнения траекторий цели заданной функцией `Trajectory`
и измеренной пеленгатором.

## Описание модели разработанного цифрового фазометра

На ***рисунке 1*** приведена модель разработанного цифрового фазметра.
На входе стоит сдвиг фазы в **180°**, необходимый для смещения динамического
диапазона измерений с **0°–360°** в **-180°–180°**. Следом конвектор сигнала,
за ним измеритель среднего значения и сумматор, которые вместе
образуют блок вычитания постоянной составляющей сигнала. 
Переключатель, который преобразует синусоиду в прямоугольный сигнал.
Блок **Pulse Converter** из двух прямоугольных сигналов, 
сдвинутых по фазе, формирует импульсы, соответствующие подъёму 
опорного сигнала (желтый) и подъёму другого сигнала (синий), что представлено на ***рисунке 2*** 
красной линией. Конструкция из генератора счётных импульсов
**(Counting Impulse Generator)** и логического блока **«И» (AND)**
заполняет импульсами смещение между сигналами, что представлено 
на ***рисунке 2*** зелёной линией. Также для дальнейшего расчёта измеряется 
период сигнала, где задействован нижний логический блок «И». Принцип 
измерения периода счётными импульсами представлен на ***рисунке 3***. Следом 
расположены четыре блока подсчёта: числа счётных импульсов; импульсов, 
соответствующих смещениям сигналов; импульсов, соответствующих периоду 
сигнала, что представлено на ***рисунке 4***, где синий линией – счётные импульсы, 
а жёлтой – периоды сигнала. Над ними установлен блок **Averaging Period Counter**, 
который отвечает за выборку числа отсчётов для усреднения вывода или, по-другому можно сказать,
отвечает за скорость работы цифрового фазометра. Далее рассчитывается среднее значение числа счётных 
импульсов и периодов сигнала за время измерения. В итоге блок **Calculate Diff**
рассчитывает разность фаз между сигналами. Блок **Range Normalization** фильтрует 
случайные выбросы, когда измеренная разность фаз выходит за допустимый диапазон.

<figure>
<img src="https://github.com/Stergrim/Simulation-of-the-operation-of-a-three-antenna-phase-direction-finder/blob/main/demos/ModelPMD.png" width="1400"/>

***Рисунок 1 - Разработанная модель измерителя разности фаз,
принцип работы которого основан на схеме цифрового фазометра***
</figure>

<figure>
<img src="https://github.com/Stergrim/Simulation-of-the-operation-of-a-three-antenna-phase-direction-finder/blob/main/demos/PhaseDetect.png" width="600"/>

***Рисунок 2 - Принцип измерения фазовой задержки, где желтым и синим
цветом – это сигналы между которыми измеряется разность фаз, зелёным
цветом представлены счётные импульсы <br> (для наглядности ширина счётных импульсов увеличена)***
</figure>

<figure>
<img src="https://github.com/Stergrim/Simulation-of-the-operation-of-a-three-antenna-phase-direction-finder/blob/main/demos/PeriodDetect.png" width="600"/>

***Рисунок 3 - Принцип измерения периода сигнала,
где желтый – сигнал, красный – счётные импульсы,
которыми измеряется полупериод сигнала <br> (для наглядности ширина счётных импульсов увеличена)***
</figure>

<figure>
<img src="https://github.com/Stergrim/Simulation-of-the-operation-of-a-three-antenna-phase-direction-finder/blob/main/demos/CalcPhaseDiff.png" width="600"/>

***Рисунок 4 - Принцип расчёта фазового сдвига, где синий – количество
счётных импульсов, желтый – количество периодов сигнала***
</figure>

На ***рисунке 5*** представлено среднее квадратичное отклонение (СКО)
измерений разности фаз цифровым фазометром.
Измерения проводились каждые **0,5°**, потом
по модулю усреднялись для промежутка в **10°** для наглядной визуализации
погрешности. В итоге СКО по всему диапазону измерений составил **0,63°**,
что показано на ***рисунке 5*** красной пунктирной линией.

<figure>
<img src="https://github.com/Stergrim/Simulation-of-the-operation-of-a-three-antenna-phase-direction-finder/blob/main/demos/ErrorPMD.png" width="600"/>

***Рисунок 5 - Среднее квадратичное отклонение измерений разности фаз цифровым фазометром***
</figure>

## Замечания

Возможно улучшить работу цифрового фазометра при наличии шумов за счёт изменения порога
преобразования синусоидального сигнала в прямоугольный, сейчас порог составляет **0**,
т.е. при пересечении нуля начинается прямоугольный сигнал. Возможно стоит выставить
это значение на амплитуду минимально принимаемого сигнала, т.е. только при достижении
минимальной пороговой амплитуды начинать преобразовывать синусоиду в прямоугольный сигнал.
Это конечно увеличит погрешность измерения разности фаз, но улучшить работу
в условиях зашумленности сигнала.

## Полезные команды для работы с Simulink моделями

В файле `UsefulCommands` содержатся полезные команды и функции для работы с моделью Simulink
и для контроля процесса симуляции.
